<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Dashboard de Casos</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>

  <!-- Header con Logo y Sesi칩n -->
  <header class="tecnico-header">
    <div style="display: flex; align-items: center; gap: 1rem;">
      <img src="{{ url_for('static', filename='img/Logo.jpg') }}" alt="Logo HelpDesk" style="width: 50px; height: 50px; border-radius: 50%;">
      <h1>HelpDesk Asistente</h1>
    </div>
    <div class="info-user">
      <span>游녻 {{ session['user']['id_identity'] }}</span>
      <form method="GET" action="{{ url_for('tecnico.logout') }}">
        <button class="btn-logout" type="submit">游댑 Cerrar sesi칩n</button>
      </form>
    </div>
  </header>

  <!-- Buscador -->
  <section class="busqueda-seccion">
    <form method="GET" action="{{ url_for('tecnico.dashboard') }}">
      <input type="text" name="q" placeholder="游댌 Buscar por nombre o n칰mero de caso..." value="{{ query or '' }}">
      <button type="submit">Buscar</button>
    </form>
  </section>

  <!-- Resultados si existen -->
  {% if usuarios or casos %}
  <section class="resultados">
    {% if usuarios %}
      <h2>游논 Usuarios Encontrados</h2>
      <ul>
        {% for u in usuarios %}
          <li>
            <strong>{{ u.nombre_completo }}</strong> - {{ u.telefono }} - {{ u.correo }}<br>
            游눹 {{ u.nombre_equipo }} | {{ u.marca }} | {{ u.modelo }} | {{ u.serial }}
          </li>
        {% endfor %}
      </ul>
    {% endif %}

    {% if casos %}
      <h2>游늭 Casos Encontrados</h2>
      <ul>
        {% for c in casos %}
          <li>
            <a href="{{ url_for('tecnico.ver_caso', codigo_caso=c.codigo_caso) }}">
              <strong>#{{ c.codigo_caso }}</strong> - {{ c.estado }} - {{ c.asunto }}
            </a>
          </li>
        {% endfor %}
      </ul>
    {% endif %}
  </section>
  {% endif %}

  <!-- Casos por Estado -->
  <section class="seccion">
    <div class="titulo-seccion">游늵 Casos por Estado</div>
    <div class="cards">
      <a href="{{ url_for('tecnico.pendientes') }}" class="card pendiente">
        <div class="estado-nombre">Pendientes</div>
        <div class="estado-cantidad">{{ pendientes }}</div>
      </a>
      <a href="{{ url_for('tecnico.proceso') }}" class="card proceso">
        <div class="estado-nombre">En Proceso</div>
        <div class="estado-cantidad">{{ proceso }}</div>
      </a>
      <a href="{{ url_for('tecnico.resueltos') }}" class="card resuelto">
        <div class="estado-nombre">Resueltos</div>
        <div class="estado-cantidad">{{ resueltos }}</div>
      </a>
    </div>
  </section>

  <!-- Gr치ficas -->
  <section class="seccion">
    <div class="titulo-seccion">游늳 Gr치ficas</div>
    <div class="graficas">
      <div class="grafica">
        <h4>Distribuci칩n de Casos</h4>
        <img src="data:image/png;base64,{{ piechart }}" alt="Gr치fico de Distribuci칩n">
      </div>
      <div class="grafica">
        <h4>Casos por Estado</h4>
        <img src="data:image/png;base64,{{ barchart }}" alt="Gr치fico de Barras">
      </div>
      <div class="grafica">
        <h4>Tendencia de Casos</h4>
        <img src="data:image/png;base64,{{ linechart }}" alt="Gr치fico de L칤nea">
      </div>
    </div>
  </section>

<div class="imagen-flotante">
  <img src="{{ url_for('static', filename='img/tecnico.png') }}" alt="T칠cnico flotante">
</div>

</body>
</html>
